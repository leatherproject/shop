# Сайт на PHP

## Установка PHP

 - Устанавливаем модуль для чтения JSON:
   ```
   sudo apt install php-cli php-json
   ```
   переходим в папку проекта
   ```
   cd site-php
   ```
   находясь в папке проекта запускаем сервер
   ```
   php -S localhost:8000
   ```

 - Js-файлы - отличия:

    Нужный файл подключаем в `gallery.html`
 
   `fetch-gallery.js`- загрузка всех изображений вместе с модальными

   `fetch-gallery-lazy.js`- отложенная загрузка методом GET HTTP - с установкой src при открытии модал. окна;
   Сообщение - "Загрузка изображения..."
   Если изображения указаного в JSON нет в папке img, или сервер остановлен - используется одно сообщение для двух случаев
   "Не удалось загрузить изображение"

   `fetch-gallery-lazy-v.js` - используются асинхр. функции `checkImage` и `showModal`
   Здесь, при открытии модалки отслеживаются два этапа: 
   - проверка на наличие в папке img изображения указаного в JSON - сообщение "Поиск файла..."
     и
   - если файл найден - загрузка методом GET HTTP, сообщение "Загрузка изображения..."

   Исключения:
   - если файл не найден - сообщение "Файл не найден"
   - если сервер остановлен - сообщение "Ошибка сети"

   Из-за мгновенной смены сообщений, для тестирования используются setTimeout - не забыть заккоментировать

   Код работает, но из-за кода для слайдера - вызывает предупреждения на хостинге!!!.
   Что-бы убрать предупреждение - использую 'use strict'; в начале файла!!!

   Рефакторинг - вытащил функции из `fetchData()`

   TODO - 21 июня 2025
   - файл `fetchGallery-lazy.js` переименовать в `fetch-gallery-lazy.js`, далее в нём:
     - добавить `'use strict';`
     - вытащить функции из `fetchProducts()` (переименовать в `fetchData()`) 
     - отрефакторить по аналогии с файлом `fetch-products-lazy-v.js`;
     - вставить код слайдера;
     - при открытии модального - вместо сообщения 'Не удалось загрузить изображение' - вставлять изобр.-заглушку (как вариант);

   - в файлах `fetch-gallery-lazy.js` и `fetch-gallery-lazy-v.js`:
     - реализовать отложенную загрузку для слайдера с помощью атрибутов loading="lazy" - в превью и в модальных,
     или с помощью установки src через dataset при открытии окна;

   - отрефакторить файл `fetch-workshop.js` по аналогии с файлом `fetch-products-lazy-v.js`;
   - отрефакторить `workshop.css` - блоки `.top`

   - слайдеры: во всех файлах со слайдерами без тематики - абстраргировать имена слайдеров и их CSS-классы 
   - в будущем, добавить для конкретных товаров свой слайдер - имя слайдера соответствующее товару, или
     самописное решение (не слайдер) для каждого изделия - смена 2-3 изображений при клике.

   TODO - 19 авг. 2025
   только в файлах `fetch-workshop_flat.js` и `fetch-gallery-lazy-v_flat.js` сделать следующее: 

   - заменить строку 
     `const newProducts = json.data.filter(item => item.page === 'ourProducts' && item.new === true);`

   на

   `const newProducts = json.data.filter(item => item.page === 'ourProducts' && item.new);`

   это даст возможность указывать в таблице данных `db-Json` в поле new любое слово вместо `true` - для отображения маркера
   `new`

   - протестировать!

## для Google Sheets
   
   - скрипт допускает писать цены в следующих видах:

     `2800.50`
     `1 950,57 грн.`
     `10 350.75`
     `3000`
     `2 500.50`
     `1800,65`
     `900`

   - если в таблице данных `db-Json` поле limit пусто или содержит не числовые символы - например, `r5/` - 
     тогда, в карточке товара отобразится вопр. знак а увеличение/уменьшение товара в корзине не сработает.

   - при случайном заполнении поля `width` для категории которая не явл. `belt` - ошибок не возникает, поле 
     `width` в заказе не появится.

## кодировка моделей

   `BA0SH0H2 `
    BA - BAG
    0 - разделитель
    SH - шоппер
    H (handles) - особенность модели (в данном случае ручки)
    2 - комбинация из двух цветов (ручки)

    `WA32CL0DE` - кошелёк с "глазком"
    WA - Wallet, женский
    3 - основных отделов
    2 - карты 
    CL - clutch
    DE - decor

    `WA2Z8TR`
 
    `WA14TRHF`
     TR - travel
     HF Half flap → “половинчатый клапан”
     или
     CF - Cover flap → просто крышка/клапан
     
    `PU24BF`
     PU - Purse, мужской
     BF - bi-fold

     для кошельков, портмоне, сумок при комбинации со вторым цветом, в конце ставим `2` (если цвет один - не ставим ничего):
     например, `WA2Z8TR2`

     при растишке используем в самом конце - `VEG` через разделитель `0`, например:
     `WA2Z8TR2VEG` - два цвета
     `WA2Z8TR0VEG` - один цвет
         
     ремни из безымянной кожи (не брендированная) - даём имя ориентируясь на особенности кожи:

     `EDGE0NIC2M` - бежевый срез или
     `CONTRAST0ANT3M`

     `GGRO0ANT3M` - Gazzele gropone
     `RWOOD0ANT1M` - rose wood - паллисандровый цвет

     пряжки:
     STL - нержавейка
     BRS - латунь
     NIC - никель 
     ANT - антик
     3 - версия пряжки
     M - мужская 
     W - женская
 
     `ANT3M`
     `STL3W`
     `NIC3M`
     
## Таблица заказов
Таблица `orders`
Лист `orders_list`

Поля:

`now	phone	model	name	price	Qty	selectedColor	selectedWidth	waist`

для развёртывания проекта таблицы заказов `orders`- (Google Apps Script, функция `doPost`) -
 - Выполнять от имени: Меня (владельца)
 - Кто имеет доступ: Все




